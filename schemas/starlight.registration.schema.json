{
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "$id": "https://starlight-protocol.github.io/schemas/starlight.registration.schema.json",
    "title": "starlight.registration",
    "description": "Registration message for Sentinels and Intent clients connecting to the Hub",
    "type": "object",
    "properties": {
        "jsonrpc": {
            "const": "2.0",
            "description": "JSON-RPC version, must be 2.0"
        },
        "method": {
            "const": "starlight.registration",
            "description": "Protocol method name"
        },
        "params": {
            "type": "object",
            "description": "Registration parameters",
            "properties": {
                "layer": {
                    "type": "string",
                    "description": "Unique identifier for this client (e.g., 'PulseSentinel', 'JanitorSentinel')",
                    "minLength": 1
                },
                "priority": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 100,
                    "description": "Priority level (1 = highest, 100 = lowest). Lower numbers preempt higher during hijack conflicts."
                },
                "capabilities": {
                    "type": "array",
                    "items": {
                        "type": "string",
                        "enum": [
                            "stability",
                            "obstacle-removal",
                            "vision",
                            "pii-detection",
                            "intent",
                            "accessibility",
                            "audit",
                            "wcag",
                            "context-injection",
                            "data-extraction",
                            "compliance",
                            "responsive",
                            "mobile",
                            "detection",
                            "stealth",
                            "anti-bot",
                            "evasion"
                        ]
                    },
                    "description": "Array of capability flags this client supports"
                },
                "selectors": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    },
                    "description": "CSS selectors this Sentinel monitors for blocking elements"
                },
                "version": {
                    "type": "string",
                    "pattern": "^[0-9]+\\.[0-9]+\\.[0-9]+$",
                    "description": "Protocol version (semver format, e.g., '1.0.0')"
                },
                "authToken": {
                    "type": "string",
                    "description": "Authentication token for secured Hub connections"
                }
            },
            "required": [
                "layer",
                "priority"
            ]
        },
        "id": {
            "type": "string",
            "description": "Unique message ID for request/response correlation"
        }
    },
    "required": [
        "jsonrpc",
        "method",
        "params",
        "id"
    ]
}